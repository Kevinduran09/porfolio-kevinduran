---
// src/pages/projects/[slug].astro
import { getProjects, getProjectById } from "@/data/projects";
import Layout from "@/layouts/Layout.astro";
import Footer from "@/components/Footer.astro";
import TechnicalSections from "@/sections/TechnicalSections.astro";

// Generar rutas estáticas para todos los proyectos
export async function getStaticPaths() {
  const projects = getProjects();
  return projects.map((project) => ({
    params: { slug: project.id },
  }));
}

// Obtener datos del proyecto
const { slug } = Astro.params;
const project = getProjectById(slug as string);

if (!project) {
  throw new Error("Proyecto no encontrado");
}

// Metadata del proyecto
const title = `${project.title} | Proyecto`;
const description = project.description;

// Imagen principal del proyecto
const mainImage = project.images?.[0] || "/coming-soon.webp";
---

<Layout title={title} description={description}>
  <div class="min-h-screen bg-background">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
      <!-- Header del Proyecto -->
      <header
        class="mb-8"
        data-aos="fade-down"
        data-aos-delay="150"
        data-aos-duration="900"
      >
        <h1
          transition:name={`title-${project.title}`}
          class="text-4xl font-title font-black leading-none md:text-6xl lg:text-5xl 2xl:text-7xl mb-8"
        >
          {project.title}
        </h1>

        <p class="text-2xl mb-3">
          ¿Qué es {project.title}?
        </p>

        <p class="text-lg text-neutral-300 leading-relaxed">
          {project.description}
        </p>
      </header>

      <!-- Imagen Principal -->
      <div
        id="project-image"
        class="mb-8 overflow-hidden"
        data-aos="fade-right"
        data-aos-delay="300"
        data-aos-duration="1100"
        data-aos-once="true"
      >
        <div class="aspect-video relative overflow-hidden rounded-lg">
          <img
            transition:name={`image-${project.title}`}
            src={mainImage}
            alt={`Imagen descriptiva del proyecto ${project.title}`}
            class="object-fill w-full h-full"
            loading="lazy"
          />
        </div>
      </div>

      <!-- Tecnologías Utilizadas -->
      <section
        id="project-tech"
        class="mb-8"
        data-aos="fade-up"
        data-aos-delay="200"
        data-aos-duration="0000"
      >
        <div class="text-center">
          <h2 class="text-2xl font-bold mb-2">Tecnologías Utilizadas</h2>

          <p class="text-neutral-400 mb-4">
            Stack tecnológico empleado en el desarrollo del proyecto
          </p>

          <div class="flex flex-wrap justify-center gap-5 p-4 tech-container">
            {
              project.technologies.map((tech, idx) => (
                <img class="size-12" src={tech.icon} alt={tech.alt} />
              ))
            }
          </div>
        </div>
      </section>

      <!-- Secciones Técnicas -->
      <div
        data-aos="fade-up"
        data-aos-delay="400"
        data-aos-duration="1000"
        data-aos-once="true"
      >
        <TechnicalSections sections={project.sections || []} />
      </div>
    </div>
  </div>

  <Footer />
</Layout>
